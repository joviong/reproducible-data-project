dat <- read_csv("data/1991-2020_afl_team_data_tidy.csv")

str(dat)

head(dat, n=10)

tail(dat)

sum(is.na(dat))

which(is.na(dat), arr.ind = TRUE)

filter(dat, is.na(Round))

naniar::vis_miss(dat)

dat <- replace_na(dat, list(Round = "Final"))

sum(is.na(dat))

table(dat$match_outcome)

dat %>%
  count(match_outcome)

prop.table(table(dat$match_outcome))

dat %>%
  count(match_outcome) %>%
  mutate(prop = round(prop.table(n), 3))

dat %>%
  count(Home.team, match_outcome) %>%
  group_by(Home.team) %>%
  mutate(prop = round(prop.table(n), 3))

dat %>%
  group_by(match_outcome) %>%
  summarise(mean_points = mean(Home.score))

## median is a good option for non-normal distributions

score <- sample(dat$Home.score, size = 50)
score

distances <- score - mean(score)
distances

squared_distances <- distances^2
squared_distances

variance <- sum(squared_distances)/length(score)-1
variance

standard_deviation <- sqrt(variance)
standard_deviation

sd(score)

dat %>%
  summarise(sd_tackles = sd(Tackles), sd_Kicks = sd(Kicks))

dat %>%
  summarise(mn_tackles = mean(Tackles),
            mn_kicks = mean(Kicks))

dat %>%
  summarise(mn_tackles = mean(Tackles), sd_tackles = sd(Tackles),
            mn_kicks = mean(Kicks), sd_kicks = sd(Kicks)) %>%
  mutate(cv_tackles = sd_tackles/mn_tackles,
         cv_kicks = sd_kicks/mn_kicks)

sort(score)

quantile(score)

quantile(score, c(0.25, 0.75))

IQR(score)

bw_teams <- df %>%
  filter(Season == 2019) %>%  ##Filter takes only the values from the outlined variable
  group_by(Home.team) %>%
  summarise(mean = mean(Home.score))

bw_teams

between_sd <- sd(bw_teams$mean)
between_sd

wn_teams <- df %>%
  filter(Season == 2019) %>%
  group_by(Home.team) %>%
  summarise(sd = sd(Home.score))
wn_teams

within_sd <- mean(wn_teams$sd)
within_sd

overall <- dat %>%
  filter(Season == 2019) %>%
  summarise(sd = sd(Home.score), var = var(Home.score))
overall
