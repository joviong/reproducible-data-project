sprint <- read_csv("data/sprint-testing-data.csv")
str(sprint)
head(sprint)
tail(sprint)
sum(is.na(sprint))
which(is.na(sprint), arr.ind = TRUE)
naniar::vis_miss(sprint)
sprint_long <- pivot_longer(data = sprint, 
                            cols = pre_1:post_3,
                            names_to = "time_point",
                            values_to = "sprint_time")
sprint_long <- separate(data = sprint_long,
                        col = time_point,
                        into = c("testing_session", "trial"))
sprint_tidy <- drop_na(sprint_long)
sprint_summary <- sprint_tidy %>%
  group_by(athlete, testing_session)%>%
  summarise(mean_time = round(mean(sprint_time), 2), best_time = min(sprint_time))
sprint_summary <- sprint_summary %>%
  pivot_wider(names_from = testing_session,
              values_from = mean_time:best_time)
sprint_summary <- sprint_summary %>%
  select(athlete, mean_time_pre, best_time_pre, mean_time_post, best_time_post)
sprint_summary %>%
  arrange(best_time_post)
sprint_summary <- sprint_summary %>%
  mutate(best_time_diff = best_time_post - best_time_pre)
library(readxl)
yyir <- read_excel("data/yyir.xlsx")
testing <- full_join(sprint_summary, yyir, by = "athlete")

#barchart examples#
dat %>%
  count(Home.team, match_outcome) %>%
  group_by(Home.team) %>%
  mutate(prop = round(prop.table(n), 3)) %>%
  ggplot() +
  geom_bar(mapping = aes(x = Home.team, y = prop, fill = match_outcome), stat = "identity")
  theme(axis.text.x = element_text(angle = 45))